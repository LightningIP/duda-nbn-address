define(["exports","../../composables/toggleScope.js","../../../../vue/dist/vue.runtime.esm-bundler.js","./util/point.js","../../util/index.js","../../util/box.js","../../util/propsFactory.js","../../../../@vue/reactivity/dist/reactivity.esm-bundler.js","../../util/globals.js","../../../../@vue/runtime-core/dist/runtime-core.esm-bundler.js","../../util/animation.js","../../util/isFixedPosition.js","../../util/helpers.js","../../util/anchor.js","../../util/getScrollParent.js","../../util/console.js"],function(H,Y,ae,I,le,S,G,L,J,p,K,Q,d,s,Z,$){"use strict";const k={static:te,connected:oe},_=G.propsFactory({locationStrategy:{type:[String,Function],default:"static",validator:e=>typeof e=="function"||e in k},location:{type:String,default:"bottom"},origin:{type:String,default:"auto"},offset:[Number,String,Array]},"VOverlay-location-strategies");function ee(e,o){const g=L.ref({}),h=L.ref();J.IN_BROWSER&&Y.useToggleScope(()=>!!(o.isActive.value&&e.locationStrategy),A=>{var v,F;p.watch(()=>e.locationStrategy,A),L.onScopeDispose(()=>{window.removeEventListener("resize",O),h.value=void 0}),window.addEventListener("resize",O,{passive:!0}),typeof e.locationStrategy=="function"?h.value=(v=e.locationStrategy(o,e,g))==null?void 0:v.updateLocation:h.value=(F=k[e.locationStrategy](o,e,g))==null?void 0:F.updateLocation});function O(A){var v;(v=h.value)==null||v.call(h,A)}return{contentStyles:g,updateLocation:h}}function te(){}function ie(e,o){const g=K.nullifyTransforms(e);return o?g.x+=parseFloat(e.style.right||0):g.x-=parseFloat(e.style.left||0),g.y-=parseFloat(e.style.top||0),g}function oe(e,o,g){(Array.isArray(e.target.value)||Q.isFixedPosition(e.target.value))&&Object.assign(g.value,{position:"fixed",top:0,[e.isRtl.value?"right":"left"]:0});const{preferredAnchor:O,preferredOrigin:A}=d.destructComputed(()=>{const r=s.parseAnchor(o.location,e.isRtl.value),t=o.origin==="overlap"?r:o.origin==="auto"?s.flipSide(r):s.parseAnchor(o.origin,e.isRtl.value);return r.side===t.side&&r.align===s.flipAlign(t).align?{preferredAnchor:s.flipCorner(r),preferredOrigin:s.flipCorner(t)}:{preferredAnchor:r,preferredOrigin:t}}),[v,F,V,C]=["minWidth","minHeight","maxWidth","maxHeight"].map(r=>p.computed(()=>{const t=parseFloat(o[r]);return isNaN(t)?1/0:t})),x=p.computed(()=>{if(Array.isArray(o.offset))return o.offset;if(typeof o.offset=="string"){const r=o.offset.split(" ").map(parseFloat);return r.length<2&&r.push(0),r}return typeof o.offset=="number"?[o.offset,0]:[0,0]});let z=!1;const R=new ResizeObserver(()=>{z&&P()});p.watch([e.target,e.contentEl],(r,t)=>{let[y,w]=r,[f,c]=t;f&&!Array.isArray(f)&&R.unobserve(f),y&&!Array.isArray(y)&&R.observe(y),c&&R.unobserve(c),w&&R.observe(w)},{immediate:!0}),L.onScopeDispose(()=>{R.disconnect()});function P(){if(z=!1,requestAnimationFrame(()=>z=!0),!e.target.value||!e.contentEl.value)return;const r=S.getTargetBox(e.target.value),t=ie(e.contentEl.value,e.isRtl.value),y=Z.getScrollParents(e.contentEl.value),w=12;y.length||(y.push(document.documentElement),e.contentEl.value.style.top&&e.contentEl.value.style.left||(t.x-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-x")||0),t.y-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-y")||0)));const f=y.reduce((l,a)=>{const i=a.getBoundingClientRect(),n=new S.Box({x:a===document.documentElement?0:i.x,y:a===document.documentElement?0:i.y,width:a.clientWidth,height:a.clientHeight});return l?new S.Box({x:Math.max(l.left,n.left),y:Math.max(l.top,n.top),width:Math.min(l.right,n.right)-Math.max(l.left,n.left),height:Math.min(l.bottom,n.bottom)-Math.max(l.top,n.top)}):n},void 0);f.x+=w,f.y+=w,f.width-=w*2,f.height-=w*2;let c={anchor:O.value,origin:A.value};function D(l){const a=new S.Box(t),i=I.anchorToPoint(l.anchor,r),n=I.anchorToPoint(l.origin,a);let{x:m,y:b}=I.getOffset(i,n);switch(l.anchor.side){case"top":b-=x.value[0];break;case"bottom":b+=x.value[0];break;case"left":m-=x.value[0];break;case"right":m+=x.value[0];break}switch(l.anchor.align){case"top":b-=x.value[1];break;case"bottom":b+=x.value[1];break;case"left":m-=x.value[1];break;case"right":m+=x.value[1];break}return a.x+=m,a.y+=b,a.width=Math.min(a.width,V.value),a.height=Math.min(a.height,C.value),{overflows:S.getOverflow(a,f),x:m,y:b}}let j=0,T=0;const M={x:0,y:0},B={x:!1,y:!1};let ne=-1;for(;;){if(ne++>10){$.consoleError("Infinite loop detected in connectedLocationStrategy");break}const{x:l,y:a,overflows:i}=D(c);j+=l,T+=a,t.x+=l,t.y+=a;{const n=s.getAxis(c.anchor),m=i.x.before||i.x.after,b=i.y.before||i.y.after;let N=!1;if(["x","y"].forEach(u=>{if(u==="x"&&m&&!B.x||u==="y"&&b&&!B.y){const E={anchor:{...c.anchor},origin:{...c.origin}},X=u==="x"?n==="y"?s.flipAlign:s.flipSide:n==="y"?s.flipSide:s.flipAlign;E.anchor=X(E.anchor),E.origin=X(E.origin);const{overflows:W}=D(E);(W[u].before<=i[u].before&&W[u].after<=i[u].after||W[u].before+W[u].after<(i[u].before+i[u].after)/2)&&(c=E,N=B[u]=!0)}}),N)continue}i.x.before&&(j+=i.x.before,t.x+=i.x.before),i.x.after&&(j-=i.x.after,t.x-=i.x.after),i.y.before&&(T+=i.y.before,t.y+=i.y.before),i.y.after&&(T-=i.y.after,t.y-=i.y.after);{const n=S.getOverflow(t,f);M.x=f.width-n.x.before-n.x.after,M.y=f.height-n.y.before-n.y.after,j+=n.x.before,t.x+=n.x.before,T+=n.y.before,t.y+=n.y.before}break}const re=s.getAxis(c.anchor);return Object.assign(g.value,{"--v-overlay-anchor-origin":`${c.anchor.side} ${c.anchor.align}`,transformOrigin:`${c.origin.side} ${c.origin.align}`,top:d.convertToUnit(U(T)),left:e.isRtl.value?void 0:d.convertToUnit(U(j)),right:e.isRtl.value?d.convertToUnit(U(-j)):void 0,minWidth:d.convertToUnit(re==="y"?Math.min(v.value,r.width):v.value),maxWidth:d.convertToUnit(q(d.clamp(M.x,v.value===1/0?0:v.value,V.value))),maxHeight:d.convertToUnit(q(d.clamp(M.y,F.value===1/0?0:F.value,C.value)))}),{available:M,contentBox:t}}return p.watch(()=>[O.value,A.value,o.offset,o.minWidth,o.minHeight,o.maxWidth,o.maxHeight],()=>P()),p.nextTick(()=>{const r=P();if(!r)return;const{available:t,contentBox:y}=r;y.height>t.y&&requestAnimationFrame(()=>{P(),requestAnimationFrame(()=>{P()})})}),{updateLocation:P}}function U(e){return Math.round(e*devicePixelRatio)/devicePixelRatio}function q(e){return Math.ceil(e*devicePixelRatio)/devicePixelRatio}H.makeLocationStrategyProps=_,H.useLocationStrategies=ee,Object.defineProperty(H,Symbol.toStringTag,{value:"Module"})});
