define(["exports","../../composables/toggleScope","../../../../vue/dist/vue.runtime.esm-bundler","./util/point","../../util/index","../../util/box","../../util/propsFactory","../../../../@vue/reactivity/dist/reactivity.esm-bundler","../../util/globals","../../../../@vue/runtime-core/dist/runtime-core.esm-bundler","../../util/animation","../../util/isFixedPosition","../../util/helpers","../../util/anchor","../../util/getScrollParent","../../util/console"],function(I,Y,ae,U,le,S,G,W,J,p,K,Q,d,f,Z,$){"use strict";const k={static:te,connected:oe},_=G.propsFactory({locationStrategy:{type:[String,Function],default:"static",validator:e=>typeof e=="function"||e in k},location:{type:String,default:"bottom"},origin:{type:String,default:"auto"},offset:[Number,String,Array]},"VOverlay-location-strategies");function ee(e,o){const g=W.ref({}),h=W.ref();J.IN_BROWSER&&Y.useToggleScope(()=>!!(o.isActive.value&&e.locationStrategy),A=>{var v,R;p.watch(()=>e.locationStrategy,A),W.onScopeDispose(()=>{window.removeEventListener("resize",F),h.value=void 0}),window.addEventListener("resize",F,{passive:!0}),typeof e.locationStrategy=="function"?h.value=(v=e.locationStrategy(o,e,g))==null?void 0:v.updateLocation:h.value=(R=k[e.locationStrategy](o,e,g))==null?void 0:R.updateLocation});function F(A){var v;(v=h.value)==null||v.call(h,A)}return{contentStyles:g,updateLocation:h}}function te(){}function ie(e,o){const g=K.nullifyTransforms(e);return o?g.x+=parseFloat(e.style.right||0):g.x-=parseFloat(e.style.left||0),g.y-=parseFloat(e.style.top||0),g}function oe(e,o,g){(Array.isArray(e.target.value)||Q.isFixedPosition(e.target.value))&&Object.assign(g.value,{position:"fixed",top:0,[e.isRtl.value?"right":"left"]:0});const{preferredAnchor:F,preferredOrigin:A}=d.destructComputed(()=>{const r=f.parseAnchor(o.location,e.isRtl.value),t=o.origin==="overlap"?r:o.origin==="auto"?f.flipSide(r):f.parseAnchor(o.origin,e.isRtl.value);return r.side===t.side&&r.align===f.flipAlign(t).align?{preferredAnchor:f.flipCorner(r),preferredOrigin:f.flipCorner(t)}:{preferredAnchor:r,preferredOrigin:t}}),[v,R,V,C]=["minWidth","minHeight","maxWidth","maxHeight"].map(r=>p.computed(()=>{const t=parseFloat(o[r]);return isNaN(t)?1/0:t})),x=p.computed(()=>{if(Array.isArray(o.offset))return o.offset;if(typeof o.offset=="string"){const r=o.offset.split(" ").map(parseFloat);return r.length<2&&r.push(0),r}return typeof o.offset=="number"?[o.offset,0]:[0,0]});let B=!1;const T=new ResizeObserver(()=>{B&&P()});p.watch([e.target,e.contentEl],(r,t)=>{let[y,w]=r,[s,c]=t;s&&!Array.isArray(s)&&T.unobserve(s),y&&!Array.isArray(y)&&T.observe(y),c&&T.unobserve(c),w&&T.observe(w)},{immediate:!0}),W.onScopeDispose(()=>{T.disconnect()});function P(){if(B=!1,requestAnimationFrame(()=>B=!0),!e.target.value||!e.contentEl.value)return;const r=S.getTargetBox(e.target.value),t=ie(e.contentEl.value,e.isRtl.value),y=Z.getScrollParents(e.contentEl.value),w=12;y.length||(y.push(document.documentElement),e.contentEl.value.style.top&&e.contentEl.value.style.left||(t.x-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-x")||0),t.y-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-y")||0)));const s=y.reduce((l,a)=>{const i=a.getBoundingClientRect(),n=new S.Box({x:a===document.documentElement?0:i.x,y:a===document.documentElement?0:i.y,width:a.clientWidth,height:a.clientHeight});return l?new S.Box({x:Math.max(l.left,n.left),y:Math.max(l.top,n.top),width:Math.min(l.right,n.right)-Math.max(l.left,n.left),height:Math.min(l.bottom,n.bottom)-Math.max(l.top,n.top)}):n},void 0);s.x+=w,s.y+=w,s.width-=w*2,s.height-=w*2;let c={anchor:F.value,origin:A.value};function D(l){const a=new S.Box(t),i=U.anchorToPoint(l.anchor,r),n=U.anchorToPoint(l.origin,a);let{x:m,y:b}=U.getOffset(i,n);switch(l.anchor.side){case"top":b-=x.value[0];break;case"bottom":b+=x.value[0];break;case"left":m-=x.value[0];break;case"right":m+=x.value[0];break}switch(l.anchor.align){case"top":b-=x.value[1];break;case"bottom":b+=x.value[1];break;case"left":m-=x.value[1];break;case"right":m+=x.value[1];break}return a.x+=m,a.y+=b,a.width=Math.min(a.width,V.value),a.height=Math.min(a.height,C.value),{overflows:S.getOverflow(a,s),x:m,y:b}}let E=0,M=0;const L={x:0,y:0},N={x:!1,y:!1};let ne=-1;for(;;){if(ne++>10){$.consoleError("Infinite loop detected in connectedLocationStrategy");break}const{x:l,y:a,overflows:i}=D(c);E+=l,M+=a,t.x+=l,t.y+=a;{const n=f.getAxis(c.anchor),m=i.x.before||i.x.after,b=i.y.before||i.y.after;let j=!1;if(["x","y"].forEach(u=>{if(u==="x"&&m&&!N.x||u==="y"&&b&&!N.y){const O={anchor:{...c.anchor},origin:{...c.origin}},X=u==="x"?n==="y"?f.flipAlign:f.flipSide:n==="y"?f.flipSide:f.flipAlign;O.anchor=X(O.anchor),O.origin=X(O.origin);const{overflows:H}=D(O);(H[u].before<=i[u].before&&H[u].after<=i[u].after||H[u].before+H[u].after<(i[u].before+i[u].after)/2)&&(c=O,j=N[u]=!0)}}),j)continue}i.x.before&&(E+=i.x.before,t.x+=i.x.before),i.x.after&&(E-=i.x.after,t.x-=i.x.after),i.y.before&&(M+=i.y.before,t.y+=i.y.before),i.y.after&&(M-=i.y.after,t.y-=i.y.after);{const n=S.getOverflow(t,s);L.x=s.width-n.x.before-n.x.after,L.y=s.height-n.y.before-n.y.after,E+=n.x.before,t.x+=n.x.before,M+=n.y.before,t.y+=n.y.before}break}const re=f.getAxis(c.anchor);return Object.assign(g.value,{"--v-overlay-anchor-origin":`${c.anchor.side} ${c.anchor.align}`,transformOrigin:`${c.origin.side} ${c.origin.align}`,top:d.convertToUnit(z(M)),left:e.isRtl.value?void 0:d.convertToUnit(z(E)),right:e.isRtl.value?d.convertToUnit(z(-E)):void 0,minWidth:d.convertToUnit(re==="y"?Math.min(v.value,r.width):v.value),maxWidth:d.convertToUnit(q(d.clamp(L.x,v.value===1/0?0:v.value,V.value))),maxHeight:d.convertToUnit(q(d.clamp(L.y,R.value===1/0?0:R.value,C.value)))}),{available:L,contentBox:t}}return p.watch(()=>[F.value,A.value,o.offset,o.minWidth,o.minHeight,o.maxWidth,o.maxHeight],()=>P()),p.nextTick(()=>{const r=P();if(!r)return;const{available:t,contentBox:y}=r;y.height>t.y&&requestAnimationFrame(()=>{P(),requestAnimationFrame(()=>{P()})})}),{updateLocation:P}}function z(e){return Math.round(e*devicePixelRatio)/devicePixelRatio}function q(e){return Math.ceil(e*devicePixelRatio)/devicePixelRatio}I.makeLocationStrategyProps=_,I.useLocationStrategies=ee,Object.defineProperty(I,Symbol.toStringTag,{value:"Module"})});
