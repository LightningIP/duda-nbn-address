define(["exports","../VMenu/shared","../../composables/delay","../../../../vue/dist/vue.runtime.esm-bundler","../../util/index","../../util/propsFactory","../../util/getCurrentInstance","../../../../@vue/reactivity/dist/reactivity.esm-bundler","../../../../@vue/runtime-core/dist/runtime-core.esm-bundler","../../util/helpers","../../util/globals","../../util/bindProps"],function(h,m,T,V,W,w,D,p,n,y,N,F){"use strict";const R=w.propsFactory({target:[String,Object],activator:[String,Object],activatorProps:{type:Object,default:()=>({})},openOnClick:{type:Boolean,default:void 0},openOnHover:Boolean,openOnFocus:{type:Boolean,default:void 0},closeOnContentClick:Boolean,...T.makeDelayProps()},"VOverlay-activator");function j(t,f){let{isActive:o,isTop:v,contentEl:g}=f;const i=D.getCurrentInstance("useActivator"),l=p.ref();let c=!1,a=!1,u=!0;const r=n.computed(()=>t.openOnFocus||t.openOnFocus==null&&t.openOnHover),I=n.computed(()=>t.openOnClick||t.openOnClick==null&&!t.openOnHover&&!r.value),{runOpenDelay:O,runCloseDelay:b}=T.useDelay(t,e=>{e===(t.openOnHover&&c||r.value&&a)&&!(t.openOnHover&&o.value&&!v.value)&&(o.value!==e&&(u=!0),o.value=e)}),P=p.ref(),E={onClick:e=>{e.stopPropagation(),l.value=e.currentTarget||e.target,o.value||(P.value=[e.clientX,e.clientY]),o.value=!o.value},onMouseenter:e=>{var s;(s=e.sourceCapabilities)!=null&&s.firesTouchEvents||(c=!0,l.value=e.currentTarget||e.target,O())},onMouseleave:e=>{c=!1,b()},onFocus:e=>{y.matchesSelector(e.target,":focus-visible")!==!1&&(a=!0,e.stopPropagation(),l.value=e.currentTarget||e.target,O())},onBlur:e=>{a=!1,e.stopPropagation(),b()}},S=n.computed(()=>{const e={};return I.value&&(e.onClick=E.onClick),t.openOnHover&&(e.onMouseenter=E.onMouseenter,e.onMouseleave=E.onMouseleave),r.value&&(e.onFocus=E.onFocus,e.onBlur=E.onBlur),e}),$=n.computed(()=>{const e={};if(t.openOnHover&&(e.onMouseenter=()=>{c=!0,O()},e.onMouseleave=()=>{c=!1,b()}),r.value&&(e.onFocusin=()=>{a=!0,O()},e.onFocusout=()=>{a=!1,b()}),t.closeOnContentClick){const s=n.inject(m.VMenuSymbol,null);e.onClick=()=>{o.value=!1,s==null||s.closeParents()}}return e}),q=n.computed(()=>{const e={};return t.openOnHover&&(e.onMouseenter=()=>{u&&(c=!0,u=!1,O())},e.onMouseleave=()=>{c=!1,b()}),e});n.watch(v,e=>{var s;e&&(t.openOnHover&&!c&&(!r.value||!a)||r.value&&!a&&(!t.openOnHover||!c))&&!((s=g.value)!=null&&s.contains(document.activeElement))&&(o.value=!1)}),n.watch(o,e=>{e||setTimeout(()=>{P.value=void 0})},{flush:"post"});const k=y.templateRef();n.watchEffect(()=>{k.value&&n.nextTick(()=>{l.value=k.el})});const M=y.templateRef(),A=n.computed(()=>t.target==="cursor"&&P.value?P.value:M.value?M.el:H(t.target,i)||l.value),L=n.computed(()=>Array.isArray(A.value)?void 0:A.value);let d;return n.watch(()=>!!t.activator,e=>{e&&N.IN_BROWSER?(d=p.effectScope(),d.run(()=>{x(t,i,{activatorEl:l,activatorEvents:S})})):d&&d.stop()},{flush:"post",immediate:!0}),p.onScopeDispose(()=>{d==null||d.stop()}),{activatorEl:l,activatorRef:k,target:A,targetEl:L,targetRef:M,activatorEvents:S,contentEvents:$,scrimEvents:q}}function x(t,f,o){let{activatorEl:v,activatorEvents:g}=o;n.watch(()=>t.activator,(a,u)=>{if(u&&a!==u){const r=c(u);r&&l(r)}a&&n.nextTick(()=>i())},{immediate:!0}),n.watch(()=>t.activatorProps,()=>{i()}),p.onScopeDispose(()=>{l()});function i(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:c(),u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.activatorProps;a&&F.bindProps(a,n.mergeProps(g.value,u))}function l(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:c(),u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.activatorProps;a&&F.unbindProps(a,n.mergeProps(g.value,u))}function c(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.activator;const u=H(a,f);return v.value=(u==null?void 0:u.nodeType)===Node.ELEMENT_NODE?u:void 0,v.value}}function H(t,f){var v,g;if(!t)return;let o;if(t==="parent"){let i=(g=(v=f==null?void 0:f.proxy)==null?void 0:v.$el)==null?void 0:g.parentNode;for(;i!=null&&i.hasAttribute("data-no-activator");)i=i.parentNode;o=i}else typeof t=="string"?o=document.querySelector(t):"$el"in t?o=t.$el:o=t;return o}h.makeActivatorProps=R,h.useActivator=j,Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})});
