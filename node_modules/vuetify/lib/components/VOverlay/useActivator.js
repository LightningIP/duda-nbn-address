define(["exports","../VMenu/shared.js","../../composables/delay.js","../../../../vue/dist/vue.runtime.esm-bundler.js","../../util/index.js","../../util/propsFactory.js","../../util/getCurrentInstance.js","../../../../@vue/reactivity/dist/reactivity.esm-bundler.js","../../../../@vue/runtime-core/dist/runtime-core.esm-bundler.js","../../util/helpers.js","../../util/globals.js","../../util/bindProps.js"],function(h,S,A,V,W,m,w,p,n,y,D,T){"use strict";const N=m.propsFactory({target:[String,Object],activator:[String,Object],activatorProps:{type:Object,default:()=>({})},openOnClick:{type:Boolean,default:void 0},openOnHover:Boolean,openOnFocus:{type:Boolean,default:void 0},closeOnContentClick:Boolean,...A.makeDelayProps()},"VOverlay-activator");function R(t,f){let{isActive:o,isTop:v,contentEl:g}=f;const i=w.getCurrentInstance("useActivator"),l=p.ref();let c=!1,a=!1,u=!0;const s=n.computed(()=>t.openOnFocus||t.openOnFocus==null&&t.openOnHover),I=n.computed(()=>t.openOnClick||t.openOnClick==null&&!t.openOnHover&&!s.value),{runOpenDelay:O,runCloseDelay:b}=A.useDelay(t,e=>{e===(t.openOnHover&&c||s.value&&a)&&!(t.openOnHover&&o.value&&!v.value)&&(o.value!==e&&(u=!0),o.value=e)}),P=p.ref(),E={onClick:e=>{e.stopPropagation(),l.value=e.currentTarget||e.target,o.value||(P.value=[e.clientX,e.clientY]),o.value=!o.value},onMouseenter:e=>{var r;(r=e.sourceCapabilities)!=null&&r.firesTouchEvents||(c=!0,l.value=e.currentTarget||e.target,O())},onMouseleave:e=>{c=!1,b()},onFocus:e=>{y.matchesSelector(e.target,":focus-visible")!==!1&&(a=!0,e.stopPropagation(),l.value=e.currentTarget||e.target,O())},onBlur:e=>{a=!1,e.stopPropagation(),b()}},H=n.computed(()=>{const e={};return I.value&&(e.onClick=E.onClick),t.openOnHover&&(e.onMouseenter=E.onMouseenter,e.onMouseleave=E.onMouseleave),s.value&&(e.onFocus=E.onFocus,e.onBlur=E.onBlur),e}),$=n.computed(()=>{const e={};if(t.openOnHover&&(e.onMouseenter=()=>{c=!0,O()},e.onMouseleave=()=>{c=!1,b()}),s.value&&(e.onFocusin=()=>{a=!0,O()},e.onFocusout=()=>{a=!1,b()}),t.closeOnContentClick){const r=n.inject(S.VMenuSymbol,null);e.onClick=()=>{o.value=!1,r==null||r.closeParents()}}return e}),q=n.computed(()=>{const e={};return t.openOnHover&&(e.onMouseenter=()=>{u&&(c=!0,u=!1,O())},e.onMouseleave=()=>{c=!1,b()}),e});n.watch(v,e=>{var r;e&&(t.openOnHover&&!c&&(!s.value||!a)||s.value&&!a&&(!t.openOnHover||!c))&&!((r=g.value)!=null&&r.contains(document.activeElement))&&(o.value=!1)}),n.watch(o,e=>{e||setTimeout(()=>{P.value=void 0})},{flush:"post"});const j=y.templateRef();n.watchEffect(()=>{j.value&&n.nextTick(()=>{l.value=j.el})});const k=y.templateRef(),M=n.computed(()=>t.target==="cursor"&&P.value?P.value:k.value?k.el:F(t.target,i)||l.value),L=n.computed(()=>Array.isArray(M.value)?void 0:M.value);let d;return n.watch(()=>!!t.activator,e=>{e&&D.IN_BROWSER?(d=p.effectScope(),d.run(()=>{x(t,i,{activatorEl:l,activatorEvents:H})})):d&&d.stop()},{flush:"post",immediate:!0}),p.onScopeDispose(()=>{d==null||d.stop()}),{activatorEl:l,activatorRef:j,target:M,targetEl:L,targetRef:k,activatorEvents:H,contentEvents:$,scrimEvents:q}}function x(t,f,o){let{activatorEl:v,activatorEvents:g}=o;n.watch(()=>t.activator,(a,u)=>{if(u&&a!==u){const s=c(u);s&&l(s)}a&&n.nextTick(()=>i())},{immediate:!0}),n.watch(()=>t.activatorProps,()=>{i()}),p.onScopeDispose(()=>{l()});function i(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:c(),u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.activatorProps;a&&T.bindProps(a,n.mergeProps(g.value,u))}function l(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:c(),u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.activatorProps;a&&T.unbindProps(a,n.mergeProps(g.value,u))}function c(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.activator;const u=F(a,f);return v.value=(u==null?void 0:u.nodeType)===Node.ELEMENT_NODE?u:void 0,v.value}}function F(t,f){var v,g;if(!t)return;let o;if(t==="parent"){let i=(g=(v=f==null?void 0:f.proxy)==null?void 0:v.$el)==null?void 0:g.parentNode;for(;i!=null&&i.hasAttribute("data-no-activator");)i=i.parentNode;o=i}else typeof t=="string"?o=document.querySelector(t):"$el"in t?o=t.$el:o=t;return o}h.makeActivatorProps=N,h.useActivator=R,Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})});
